# Splunk SIEM Lab â€“ SSH Brute Force Detection

## ğŸ“Œ Overview
This project demonstrates a hands-on Splunk SIEM deployment on Linux, focusing on authentication log ingestion, failed SSH login detection, and alerting for potential brute-force attacks.

The lab simulates a SOC-style workflow including log onboarding, field extraction, detection engineering, and alert configuration.

---

## ğŸ§± Lab Environment
- **Platform:** Oracle VirtualBox
- **OS:** REMnux (Linux)
- **SIEM:** Splunk Enterprise 10.x
- **Log Source:** `/var/log/auth.log`
- **Access Method:** SSH (local simulation)

---

## âš™ï¸ Splunk Setup

### Splunk Web Interface
Splunk Enterprise was installed and accessed via the web interface.

![Splunk Home](screenshots/splunk_home.png)

---

## ğŸ“¥ Log Ingestion

The Linux authentication log was monitored and ingested into Splunk to capture login activity, including successful and failed SSH attempts.

**Monitored log file:**


Events were indexed into the default `main` index and validated through Splunk Search.

![Index Main Events](screenshots/2_index_main_events.png)


## ğŸ” Failed SSH Login Detection

Failed SSH authentication attempts were identified by searching for standard failure messages generated by `sshd`.

```spl
index=main "Failed password"

---
ğŸš¨ Brute Force Detection

To identify potential SSH brute-force activity, source IP addresses were extracted from raw authentication logs and aggregated to detect repeated failures from the same source.

index=main "Failed password"
| rex "from (?<src_ip>[0-9a-fA-F:.]+)"
| stats count by src_ip
| where count >= 1
| sort - count


This detection groups failed authentication attempts by source IP, allowing identification of suspicious login behavior.

Note: This extraction supports both IPv4 and IPv6 addresses (e.g., ::1), which are common in modern Linux environments.


ğŸ“Š Time-Based Analysis

A timechart visualization was used to analyze failed SSH login activity over time. This helps identify spikes or recurring patterns that may indicate automated attack behavior.

index=main "Failed password"
| timechart count


ğŸš¨ Alerting

A scheduled Splunk alert was created to operationalize the brute-force detection and ensure continuous monitoring.

Alert Details:

Name: Brute Force SSH Detection

Type: Scheduled

Schedule: Every 5 minutes (cron-based)

Trigger Condition: Number of results > 0

Action: Add to Triggered Alerts

*/5 * * * *


ğŸ¯ Skills Demonstrated

Splunk Enterprise SIEM deployment

Linux authentication log ingestion

SPL detection engineering

Regular expression field extraction

IPv4 and IPv6 log parsing

SSH brute-force attack detection

Scheduled alert configuration using cron

SOC-style investigation and documentation

ğŸ§  Why This Lab Matters

SSH brute-force attacks are a common initial access technique. Detecting repeated authentication failures and correlating them by source IP is a foundational SOC capability for identifying credential-based attacks early.
